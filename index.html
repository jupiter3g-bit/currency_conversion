<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>映画向け通貨換算</title>
<style>
  body { font-family: sans-serif; padding: 20px; }
  input, select, button { font-size: 1em; margin: 5px; padding: 5px; }
  .number { color: blue; font-weight: bold; }
</style>
</head>
<body>

<h2>映画向けサクッと通貨換算</h2>

<label>通貨:
<select id="fromCurrency">
  <option value="USD" selected>アメリカ</option>
  <option value="GBP">イギリス</option>
  <option value="KRW">韓国</option>
  <option value="CNY">中国</option>
  <option value="JPY">日本</option>
</select></label>

<input type="number" id="amount" placeholder="金額" />
<button id="convert">換算</button>

<div id="results"></div>

<script>
const currencyMap = {
  "USD":"アメリカ", "GBP":"イギリス", "KRW":"韓国", "CNY":"中国", "JPY":"日本"
};

const formatAmount = (num) => {
  if(typeof num !== "number" || isNaN(num)) return "取得失敗";
  if(num >= 100000000) return (num/100000000).toFixed(2)+"億";
  if(num >= 10000) return (num/10000).toFixed(2)+"万";
  return num.toFixed(0);
};

// JSON読み込み
let ratesData = {};
fetch("rates.json")
  .then(res => res.json())
  .then(data => ratesData = data)
  .catch(e => console.error("JSON読み込み失敗", e));

document.getElementById("convert").addEventListener("click", () => {
  const from = document.getElementById("fromCurrency").value;
  const amount = parseFloat(document.getElementById("amount").value);
  if(!amount) return alert("金額を入力してください");

  // 出力通貨順
  const order = ["USD","GBP","KRW","CNY","JPY"].filter(c=>c!==from);
  const displayOrder = (from==="JPY") ? ["USD", ...order.filter(c=>"USD"!==c)] : ["JPY", ...order.filter(c=>"JPY"!==c)];

  const resultsDiv = document.getElementById("results");
  resultsDiv.innerHTML = "換算結果:<br>";

  displayOrder.forEach(to=>{
    const rate = ratesData[from][to];
    const converted = rate*amount;
    resultsDiv.innerHTML += `${currencyMap[to]}: <span class="number">${formatAmount(converted)}</span><br>`;
  });
});
</script>

</body>
</html>
